{
  SibmeiExtensionAPIVersion "1.0.0"

  Initialize "() {
    AddToPluginsMenu('Sibmei extension test', null);
  }"

  InitSibmeiExtension "(api) {
    Self._property:api = api;
    Self._property:libmei = api.libmei;

    Self._property:MySymbolTemplate = CreateSparseArray('Symbol', CreateDictionary(
      'fontfam', 'myCustomFont',
      'glyph.name', 'mySymbolGlyph'
    ));

    api.RegisterSymbolHandlers(CreateDictionary(
      'Name', CreateDictionary(
        'My symbol', 'HandleMySymbol'
      )
    ), Self);

  }"

  HandleMySymbol "(obj) {
    symbolElement = api.MeiFactory(MySymbolTemplate);
    if (obj.ColorRed = 255) {
      libmei.AddAttribute(symbolElement, 'type', 'myRedType');
    }
    return symbolElement;
  }"
}
